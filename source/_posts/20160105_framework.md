title: 构思一个轻量级的HTML5棋牌游戏框架
date: 2016-01-05 21:00
---

我在思考如何构思一个通用的HTML5棋牌游戏框架
希望能够通过这套框架，降低游戏的开发复杂度，提高效率
<!-- more -->

有下面几个简单目标：
- 1.游戏引擎基于目前所使用的cocos2d-js-lite，但未来可能要替换成别的，甚至用纯HTML开发
- 2.游戏界面能够基于配置开发，不需要有太重界面的构建代码
- 3.组件化开发，希望游戏像拼装积木一样简单，在一定范围内自由增减
- 4.只做游戏的核心玩法部分，至于房间列表、商城、个人中心等等这些个性化的功能部分交给HTML去做吧。整个混合式H5游戏开发，听起来就高大上。

为了将来能够替换掉引擎，所以首先要先隔离引擎。
就像汽车只提供方向盘和档案，至于里面用的是DSG还是AT、是涡轮增压还是自然吸气不用去管。
简而言之就是封装引擎底层方法，构建一套独立于引擎的游戏模型。

根据之前斗地主开发的经验
这个框架需要实现下面几大功能：

>+ 界面渲染模块
>	- 场景（底层容器）
>	- 容器（分层）
>	- 元素（静态）
>	- 按钮（动态）
>	- 动画
>+ 界面通用组件
>	- 背景
>	- 卡牌
>	- 出牌区域
>	- 手牌区域
>	- 菜单
>	- 动画交互区域
>	- 触控区域
>+ 游戏通用功能
>	- 卡牌排序
>	- 发布/订阅事件管理器
>+ 环境适配功能
>	- 资源加载管理
>	- 屏幕自适应
>	- 声音引擎


## 全局变量
>- 卡牌种类和尺寸

## 界面渲染模块

### 场景生成器
作为游戏的父容器，并定义游戏中包含哪些容器层

### 容器分层
通过配置项定义游戏模型，将场景分层，常见的如背景层、卡牌层、菜单层、动画层、交互层。
参照css的思维,预设一下参数,用于生成场景层:

>- 尺寸宽高  width height
>- 背景图片  background
>- 是否显示  display
>- 布局位置  position (left top)   
>- 父容器id  #id
>- 显示层级  z-index

容器还会有一个children list列表，里面会包含容器层内所有的元素

### 元素
一般用于生成某张图片对应的元素:

>- 尺寸宽高  width height
>- 背景图片  background
>- 图片位置  spirte position雪碧图位置
>- 是否显示  display
>- 布局位置  position (left top)   
>- 父容器id  #id
>- 显示层级  z-index

元素除了自身的属性，还会包含一些动画及其执行方法。

### 动画
定义卡牌游戏中常见的几种动画：move、fadein、fadeout……
由于不同引擎对动画的支持不一样，所以动画这块可以自己进行封装，不做太多统一。

### 按钮
按钮基本上跟元素一致，但是会多了几个属性：
>- disabled样式
>- active样式
>- 点击事件的回调


## 界面通用组件

### 背景

### 卡牌
基于`元素`，根据配置生成不同大小、花色的卡牌，包含牌的升起和降下动画

### 出牌区域
可设定出牌区域的大小、位置、每行显示的卡牌数、排列方向

### 手牌区域
手牌区域大小、位置、发牌动画、控制其中的卡牌升起降下的方法

### 菜单
将按钮组合起来，布局到界面上

## 环境适配功能
### 资源加载管理
配置项的设计，便于合图、和加载读取

### 屏幕自适应
cocos2d-js中倒是相对粗暴一些

### 声音引擎
音效的配置项设计

## 游戏通用功能
### 卡牌排序
基本现成了
### 发布/订阅事件管理器
基本现成了




**完事具备，就差一个程序猿了**